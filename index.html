<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Pattern Marker WebAR (iOS + Android)</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />

    <!-- A-Frame core -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

    <!-- AR.js for A-Frame (PATTERN MARKERS, not NFT) -->
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.7/aframe/build/aframe-ar.js"></script>

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        background: #000;
      }

      /* Simple HUD overlay */
      #hud {
        position: fixed;
        top: env(safe-area-inset-top, 8px);
        left: 50%;
        transform: translateX(-50%);
        z-index: 10;
        padding: 6px 12px;
        background: rgba(0, 0, 0, 0.6);
        color: #ffffff;
        border-radius: 999px;
        font-size: 13px;
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        white-space: nowrap;
      }

      #hud span {
        font-weight: 600;
      }
    </style>
  </head>

  <body>
    <!-- Heads-up text / score / whatever you like -->
    <div id="hud">
      <span>Point camera at the printed marker</span>
    </div>

    <!--
      A-Frame + AR.js scene.

      Notes:
      - arjs="sourceType: webcam" → use device camera
      - embedded → canvas fills window
    -->
    <a-scene
      embedded
      vr-mode-ui="enabled: false"
      renderer="logarithmicDepthBuffer: true; antialias: true;"
      arjs="sourceType: webcam; debugUIEnabled: false;"
    >
      <!--
        Camera with mouse-based cursor so taps/clicks work on mobile.
        raycaster="objects: .clickable" → we'll mark hittable entities with class="clickable".
      -->
      <a-entity
        camera
        cursor="rayOrigin: mouse"
        raycaster="objects: .clickable"
      ></a-entity>

      <!--
        PATTERN MARKER:

        - type="pattern" because we're using .patt file
        - url="markers/myMarker.patt" must match your actual file path/name
        - Print the pattern image generated with the same tool that gave you myMarker.patt
      -->
      <a-marker type="pattern" url="marker/DirQRCode.patt">
        <!--
          Example content anchored on the marker:

          1) A flat board (from Unity) – replace MyModel.glb with your own model.
          2) A simple clickable "mole" box as a placeholder for your game interactions.
        -->

        <!-- Unity / Blender GLB model -->
        <a-entity
          id="board"
          gltf-model="url(models/MyModel.glb)"
          position="0 0 0"
          rotation="0 0 0"
          scale="0.1 0.1 0.1"
        ></a-entity>

        <!-- Simple clickable test object (mole placeholder) -->
        <a-box
          id="mole"
          class="clickable"
          position="0 0.25 0"
          depth="0.2"
          height="0.2"
          width="0.2"
          color="#ff5757"
        ></a-box>
      </a-marker>

      <!-- Always include a default camera entity in A-Frame scenes -->
      <a-entity camera></a-entity>
    </a-scene>

    <script>
      // Simple click feedback on the "mole" cube.
      // This proves tapping on 3D objects works on the marker.
      const mole = document.getElementById("mole");
      const hud = document.getElementById("hud");

      if (mole) {
        mole.addEventListener("click", () => {
          hud.textContent = "Hit!";
          // Little scale pop animation
          mole.setAttribute("scale", "0.3 0.3 0.3");
          setTimeout(() => {
            mole.setAttribute("scale", "0.2 0.2 0.2");
            hud.textContent = "Point camera at the printed marker";
          }, 150);
        });
      }
    </script>
  </body>
</html>
